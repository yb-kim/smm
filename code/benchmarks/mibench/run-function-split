#! /usr/bin/env python
import os
import subprocess

cwd = os.getcwd()
directories = []
for path in os.listdir(cwd):
    if os.path.isdir(path):
        directories.append(path)
for directory in directories:
    os.chdir(directory)
    print directory
    if os.path.isdir("function-split"):
        command = "rm -rf function-split"
        subprocess.call(command, shell=True)
    items = []
    cfiles = []
    for item in os.listdir(os.getcwd()):
        if not item in ["backup"]:
            items.append(item)
        if item.endswith(".c"):
            cfiles.append(item)
    command = "mkdir function-split; cp -r " + " ".join(items) + " function-split"
    subprocess.call(command, shell=True)

    os.chdir("function-split")
    for cfile in cfiles:
        command = "function-split %s; mv _modified.c %s" % (cfile, cfile)
        subprocess.call(command, shell=True)

    os.chdir(cwd)
